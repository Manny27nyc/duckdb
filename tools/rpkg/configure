#!/bin/sh

set -e
set -x

cd `dirname $0`

echo "R: configure"

R -q -e 'writeLines(c("# Generated by ./configure, do not edit by hand", "reserved_words <- function() {", deparse(gsub("^PG_KEYWORD..(.*).,.*,.*$", "\\\\1", grep("^PG_KEYWORD", readLines("../../third_party/libpg_query/include/parser/kwlist.hpp"), value = TRUE))), "}"), "R/reserved.R")'

if [ -z "${DUCKDB_R_DEBUG}" ]; then
  python3 rconfigure.py
else
  cd ../..
  GEN=ninja CONFIGURE_R=1 nice ${MAKE:-make} debug
fi
